{% extends "webapp/base.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prediction Result</title>

    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .card {
            border-radius: 15px;
        }
        .prediction-success {
            color: #198754;
            font-weight: bold;
        }
        .prediction-fail {
            color: #dc3545;
            font-weight: bold;
        }
        .star-rating input {
            display: none;
        }
        .star-rating label {
            font-size: 25px;
            color: gray;
            cursor: pointer;
        }
        .star-rating input:checked ~ label {
            color: gold;
        }
    </style>
</head>

<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow p-4">

        <h2 class="text-center mb-4">üö¢ Titanic Survival Prediction Result</h2>

        <!-- Passenger Details -->
        <h4>Passenger Details</h4>
        <hr>
        <p><strong>Name:</strong> {{ prediction.passenger_name }}</p>
        <p><strong>Gender:</strong> {{ prediction.gender }}</p>
        <p><strong>Age:</strong> {{ prediction.age }}</p>
        <p><strong>Parents/Children:</strong> {{ prediction.parch }}</p>
        <p><strong>Siblings/Spouses:</strong> {{ prediction.sibsp }}</p>
        <p><strong>Embarkation Port:</strong> {{ prediction.embarked }}</p>

        <hr>

        <!-- Prediction Result -->
        <h4>Prediction Outcome</h4>

        {% if prediction.survived_prediction %}
            <h3 class="prediction-success"> Likely to Survive</h3>
            <p>The model predicts that this passenger had a higher chance of survival.</p>
        {% else %}
            <h3 class="prediction-fail"> Unlikely to Survive</h3>
            <p>The model predicts that this passenger had a lower chance of survival.</p>
        {% endif %}

        <!-- Probability Progress Bar -->
        <p><strong>Survival Probability:</strong> {{ prediction.probability|floatformat:2 }}%</p>

        <div class="progress mb-4">
            <div class="progress-bar" role="progressbar"
                 style="width: {{ prediction.probability|default:0 }}%;"
                 aria-valuenow="{{ prediction.probability }}"
                 aria-valuemin="0"
                 aria-valuemax="100">
                {{ prediction.probability|floatformat:1 }}%
            </div>
        </div>

        <hr>

        <!-- Rating Section -->
        <h5>‚≠ê Rate Your Experience</h5>

        <form method="post" action="{% url 'submit_rating' prediction.id %}">
            {% csrf_token %}

            <div class="star-rating mb-3">
                <input type="radio" id="5-stars" name="rating" value="5">
                <label for="5-stars">‚òÖ</label>

                <input type="radio" id="4-stars" name="rating" value="4">
                <label for="4-stars">‚òÖ</label>

                <input type="radio" id="3-stars" name="rating" value="3">
                <label for="3-stars">‚òÖ</label>

                <input type="radio" id="2-stars" name="rating" value="2">
                <label for="2-stars">‚òÖ</label>

                <input type="radio" id="1-star" name="rating" value="1">
                <label for="1-star">‚òÖ</label>
            </div>

            <button type="submit" class="btn btn-primary">Submit Rating</button>
        </form>

        {% if message %}
            <div class="alert alert-success mt-3">
                Thank you for your rating!
            </div>
        {% endif %}

        <hr>

        <!-- Navigation Buttons -->
        <div class="d-flex justify-content-between">
            <a href="{% url 'prediction_form' %}" class="btn btn-success">
                ‚ûï Add Another Passenger
            </a>

            <a href="{% url 'home' %}" class="btn btn-secondary">
                üè† Go Home
            </a>
        </div>

    </div>
</div>

</body>
</html>

